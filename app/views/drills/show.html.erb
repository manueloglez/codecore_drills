<h2>Drill Group: <%= @drillgroup.title %> </h2>

<div class="mt-3">
  <p><%= @drill.description %></p>
  <%= form_with(url: drill_path(@drill), method: :get) do |form| %>
    <%= form.hidden_field :score, value: @score %>
    <%= form.hidden_field :answers_count, value: @answers_count %>

    <% if !params[:answer] %>
    <div>
      <%= form.label(:answer, "Your Answer", class: 'form-label') %>
      <%= form.text_area :answer, class: 'form-control' %>
    </div>
      <%= form.submit "Submit", class: "btn btn-primary mt-3" %>
    <% else %>
    <h4 class="mt-4">Your Answer: </h4>
      <div class="card m-2">
        <div class="card-body">
          <%= params[:answer] %>
        </div>
      </div>
      <% end %>
  <% end %>
  <% if params[:answer] %>
    <% if @answer_correct %>
    <div class="alert alert-success" role="alert">
      Correct!!
    </div>
    <% else %> 
    <div class="alert alert-danger" role="alert">
      Wrong!
    </div>
    <% end %>
    <h4 class="mt-4">Correct Answers: </h4>
    <% @correct_answers.each do |a| %>
      <div class="card m-2">
        <div class="card-body">
          <p><%= a %></p>
        </div>
      </div>
    <% end %>
    <% if @answers_count + 1 < @drill_list.count %>
      <%= form_with(url: drill_path(@next_drill), method: :get) do |form| %>
        <%= form.hidden_field :answers_count, value: @answers_count + 1 %>
        <%= form.hidden_field :score, value: @score %>
        <%= form.submit "Next Drill", class: "btn btn-primary mt-3 float-right" %>
      <% end %>
    <% else %>
      <%= form_with(url: drillgroup_point_path(@drillgroup, @point), method: :patch) do |form| %>
        <%= form.hidden_field :answers_count, value: @answers_count + 1 %>
        <%= form.hidden_field :correct_answers, value: @score %>
        <%= form.submit "Finish test", class: "btn btn-primary mt-3 float-right" %>
      <% end %>
    <% end %>
  <% end %>
</div>