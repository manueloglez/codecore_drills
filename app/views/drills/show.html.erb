<h2>Drill Group: <%= @drillgroup.title %> </h2>

<div class="mt-3">
  <p><%= @drill.description %></p>
  <%= form_with(url: drill_path(@drill), method: :get) do |form| %>
    <%= form.hidden_field :score, value: @score %>
    <%= form.hidden_field :answers_count, value: @answers_count %>

    <% if !params[:answer] %>
    <div>
      <%= form.label(:answer, "Your Answer", class: 'form-label') %>
      <%= form.text_area :answer, class: 'form-control' %>
    </div>
      <%= form.submit "Submit", class: "btn btn-primary mt-3" %>
    <% else %>
      <%= params[:answer] %>
    <% end %>
  <% end %>
  <% if params[:answer] %>
    <% if @answer_correct %> <h4><%= 'Correct!' %></h4>
    <% else %> <h4><%= 'Wrong!' %></h4>
    <% end %>
    <% @correct_answers.each do |a| %>
      <h5><%= a %></h5>
    <% end %>
    <% if @answers_count + 1 < @drill_list.count %>
      <%= form_with(url: drill_path(@next_drill), method: :get) do |form| %>
        <%= form.hidden_field :answers_count, value: @answers_count + 1 %>
        <%= form.hidden_field :score, value: @score %>
        <%= form.submit "Next Drill", class: "btn btn-primary mt-3 float-right" %>
      <% end %>
    <% else %>
      <%= form_with(url: drillgroup_point_path(@drillgroup, @point), method: :patch) do |form| %>
        <%= form.hidden_field :answers_count, value: @answers_count + 1 %>
        <%= form.hidden_field :correct_answers, value: @score %>
        <%= form.hidden_field :score, value: (@score * 100.0 / @answers_count).round(1) %>
        <%= form.submit "Finish test", class: "btn btn-primary mt-3 float-right" %>
      <% end %>
    <% end %>
  <% end %>
</div>